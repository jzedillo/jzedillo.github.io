---
title: "Reverse Shell Analysis"
date: 2026-02-02
categories: malware analysis
layout: single
author_profile: true
---

## Objective
We have a malicious file named `[Unknown2.exe]`. Our goal is to determine what this malicious binary does using static and dynamic analysis techniques and report our findings here.

**Tools Used**

- PE-bear
- Procmon
- Wireshark
- TCPView

## Static Analysis
Rather than using multiple different tools to view the binary strings, file hashes, windows functions, imports and size of the file, we can use `PE-bear`.

Open PE-bear → Navigate to the `General` section

This will give you a quick look at the file hashes and wether the file is packed or not. 

![unpacked](/assets/images/RevereShell/unpacked.png)

We can see the file size and loaded size are the same value indicating this file is not compressed. 

Navigating to the `strings` tab, we can see all the strings inside the binary, including a search bar where we can look for specific strings. Therefore we can go ahead and look for common IOCs (ie 'cmd', 'http', etc). 

![cmd](/assets/images/RevereShell/pebear.png)

In this case we were able to find a cmd process indicating some sort of command execution capabilities.

## Dynamic Analysis
### 1st Detonation
- No InetSim

Nothing happens that we can physcially observe, the file does not delete itself, no popup message or terminal pop up. 

### 2nd Detonation
- Wireshark + InetSim

![wireshark](/assets/images/RevereShell/wiresharkDNS.png)

We observe a DNS request to a domain `aaaaaaaaaaaa.kadusus.local`

Now we observe a DNS request to this domain, but we dont know how it is trying to connect to this DNS record.

Therefore we can trick the binary into thinking our FlareVM is the home server by configuring our /etc/hosts file and opening procmon to see how it is trying to connect.

- `nano C:\Windows\System32\drivers\etc\hosts`
  - add `127.0.0.1        aaaaaaa.kadusus.local`

![hostsFile](/assets/images/RevereShell/hostsFile.png)

- open procmon → filter by process name and operation contains TCP

![procmon](/assets/images/RevereShell/TCPreconnect.png)

We see ...

TCP View ...

![TCPestablish](/assets/images/RevereShell/TCPestablished.png)

Netcat ...

![netcat](/assets/images/RevereShell/netcatshell.png)
